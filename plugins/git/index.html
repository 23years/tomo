<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>git - Tomo</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "git";
    var mkdocs_page_input_path = "plugins/git.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Tomo</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../configuration/">Configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Commands</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../commands/init/">init</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/setup/">setup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/deploy/">deploy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/run/">run</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/tasks/">tasks</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../core/">core</a>
                </li>
                <li class="">
                    
    <a class="" href="../bundler/">bundler</a>
                </li>
                <li class="">
                    
    <a class="" href="../env/">env</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">git</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#git">git</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#settings">Settings</a></li>
        
            <li><a class="toctree-l4" href="#tasks">Tasks</a></li>
        
            <li><a class="toctree-l4" href="#helpers">Helpers</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../nodenv/">nodenv</a>
                </li>
                <li class="">
                    
    <a class="" href="../puma/">puma</a>
                </li>
                <li class="">
                    
    <a class="" href="../rails/">rails</a>
                </li>
                <li class="">
                    
    <a class="" href="../rbenv/">rbenv</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../tutorials/deploying-rails-from-scratch/">Deploying Rails From Scratch</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/writing-custom-tasks/">Writing Custom Tasks</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/publishing-a-plugin/">Publishing a Plugin</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/Host/">Tomo::Host</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Logger/">Tomo::Logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Paths/">Tomo::Paths</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/PluginDSL/">Tomo::PluginDSL</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Remote/">Tomo::Remote</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Result/">Tomo::Result</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/TaskLibrary/">Tomo::TaskLibrary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/testing/MockPluginTester/">Tomo::Testing::MockPluginTester</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/testing/DockerPluginTester/">Tomo::Testing::DockerPluginTester</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Tomo</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Plugins &raquo;</li>
        
      
    
    <li>git</li>
    <li class="wy-breadcrumbs-aside">
      
          <a href="https://github.com/mattbrictson/tomo/edit/master/docs/plugins/git.md" class="icon icon-github"
          > Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="git">git</h1>
<p>The git plugin uses git running on the remote host to fetch the code of the app being deployed. This &ldquo;remote pull&rdquo; technique is currently the only deployment method officially supported by tomo. For this to work, the SSH key you use to connect to the remote host via tomo must match the key expected by the git host (e.g. by GitHub).</p>
<h2 id="settings">Settings</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Purpose</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>git_branch</code></td>
<td>The branch of the repository to deploy</td>
<td><code>"master"</code></td>
</tr>
<tr>
<td><code>git_repo_path</code></td>
<td>Directory on the remote host where a cache of the repository will be stored</td>
<td><code>"%{deploy_to}/git_repo"</code></td>
</tr>
<tr>
<td><code>git_exclusions</code></td>
<td>An array of paths (similar to gitignore syntax) that will be excluded when the repository is copied into a release; it is recommend you exclude <code>.tomo/</code> and other directories not needed in production, like <code>spec/</code></td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>git_env</code></td>
<td>Environment variables that will be set when issuing git commands (hash)</td>
<td><code>{ GIT_SSH_COMMAND: "ssh -o PasswordAuthentication=no -o StrictHostKeyChecking=no" }</code></td>
</tr>
<tr>
<td><code>git_ref</code></td>
<td>The commit SHA or tag to deploy (overrides <code>:git_branch</code>)</td>
<td><code>nil</code></td>
</tr>
<tr>
<td><code>git_url</code></td>
<td>URL of the git repository; always use the SSH form like <code>git@github.com:username/repo.git</code> (not HTTPS)</td>
<td><code>nil</code></td>
</tr>
</tbody>
</table>
<h2 id="tasks">Tasks</h2>
<h3 id="gitclone">git:clone</h3>
<p>Performs the initial clone of the git repository. This is necessary before a deploy can be performed. The clone of the repository will be stored in the <code>git_repo_path</code>. The <code>git_url</code> setting must be specified for this task to work.</p>
<p><code>git:clone</code> is intended for use as a <a href="../../commands/setup/">setup</a> task.</p>
<h3 id="gitcreate_release">git:create_release</h3>
<p>Fetches the latest commits from <code>git_branch</code> (or <code>git_ref</code>) and creates a release by copying the contents of that branch of repository into a new release inside the <code>releases_path</code>. Releases are numbered based on the timestamp of when the deploy takes place.</p>
<p><code>git:create_release</code> is intended for use as a <a href="../../commands/deploy/">deploy</a> task.</p>
<h2 id="helpers">Helpers</h2>
<p>These helper methods become available on instances of <a href="../../api/Remote/">Remote</a> when the git plugin is loaded. They accept the same <code>options</code> as <a href="../../api/Remote/#run42command-4242options-tomoresult">Remote#run</a>.</p>
<h3 id="remotegit42args-4242options-tomoresult">remote.git(*args, **options) → <a href="../../api/Result/">Tomo::Result</a></h3>
<p>Runs <code>git</code> with the environment variables specified by the <code>git_env</code> setting.</p>
<pre><code class="ruby">remote.git(&quot;fetch&quot;)
# $ export GIT_SSH_COMMAND=ssh\ -o\ PasswordAuthentication=no\ -o\ StrictHostKeyChecking=no &amp;&amp; git fetch
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../nodenv/" class="btn btn-neutral float-right" title="nodenv">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../env/" class="btn btn-neutral" title="env"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mattbrictson/tomo/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../env/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../nodenv/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
