<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>rails - Tomo</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "rails";
    var mkdocs_page_input_path = "plugins/rails.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Tomo</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../comparisons/">Comparisons</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../configuration/">Configuration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Commands</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../commands/init/">init</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/setup/">setup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/deploy/">deploy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/run/">run</a>
                </li>
                <li class="">
                    
    <a class="" href="../../commands/tasks/">tasks</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../core/">core</a>
                </li>
                <li class="">
                    
    <a class="" href="../bundler/">bundler</a>
                </li>
                <li class="">
                    
    <a class="" href="../env/">env</a>
                </li>
                <li class="">
                    
    <a class="" href="../git/">git</a>
                </li>
                <li class="">
                    
    <a class="" href="../nodenv/">nodenv</a>
                </li>
                <li class="">
                    
    <a class="" href="../puma/">puma</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">rails</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#rails">rails</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#settings">Settings</a></li>
        
            <li><a class="toctree-l4" href="#tasks">Tasks</a></li>
        
            <li><a class="toctree-l4" href="#helpers">Helpers</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../rbenv/">rbenv</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../tutorials/deploying-rails-from-scratch/">Deploying Rails From Scratch</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/writing-custom-tasks/">Writing Custom Tasks</a>
                </li>
                <li class="">
                    
    <a class="" href="../../tutorials/publishing-a-plugin/">Publishing a Plugin</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/Host/">Tomo::Host</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Logger/">Tomo::Logger</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Paths/">Tomo::Paths</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/PluginDSL/">Tomo::PluginDSL</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Remote/">Tomo::Remote</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/Result/">Tomo::Result</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/TaskLibrary/">Tomo::TaskLibrary</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/testing/MockPluginTester/">Tomo::Testing::MockPluginTester</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/testing/DockerPluginTester/">Tomo::Testing::DockerPluginTester</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Tomo</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Plugins &raquo;</li>
        
      
    
    <li>rails</li>
    <li class="wy-breadcrumbs-aside">
      
          <a href="https://github.com/mattbrictson/tomo/edit/master/docs/plugins/rails.md" class="icon icon-github"
          > Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="rails">rails</h1>
<p>The rails plugin provides tasks for running rails and rake commands commonly used during setup and deployment, such as for precompiling assets and migrating the database. Make sure the <code>RAILS_ENV</code> environment variable is set prior to running rails tasks. The <a href="../env/">env plugin</a> is the preferred mechanism for this.</p>
<h2 id="settings">Settings</h2>
<p>None.</p>
<h2 id="tasks">Tasks</h2>
<h3 id="railsassets_precompile">rails:assets_precompile</h3>
<p>Builds the asset pipeline in preparation for deployment. This is necessary for Rails apps that use the asset pipeline, which is all new Rails apps by default. Running this task will execute this script:</p>
<pre><code>cd /var/www/my-app/releases/&lt;RELEASE_NUMBER&gt; &amp;&amp; bundle exec rake assets:precompile
</code></pre>

<p><code>rails:assets_precompile</code> is intended for use as a <a href="../../commands/deploy/">deploy</a> task. It is typically run just prior to <a href="../core/#coresymlink_current">core:symlink_current</a> to activate a new release.</p>
<h3 id="railsconsole">rails:console</h3>
<p>Starts an interactive Rails console via SSH to the remote host. This task is intended for use as a <a href="../../commands/run/">run</a> task and accepts command-line arguments. The arguments are passed through to the console. For example:</p>
<pre><code>$ tomo run -- rails:console --sandbox
</code></pre>

<p>Will run this remote script:</p>
<pre><code>cd /var/www/my-app/current &amp;&amp; bundle exec rails console --sandbox
</code></pre>

<h3 id="railsdb_migrate">rails:db_migrate</h3>
<p>Migrates the database by running:</p>
<pre><code>cd /var/www/my-app/releases/&lt;RELEASE_NUMBER&gt; &amp;&amp; bundle exec rake db:migrate
</code></pre>

<p><code>rails:db_migrate</code> is intended for use as a <a href="../../commands/deploy/">deploy</a> task. It is typically run just after <a href="../bundler/#bundlerinstall">bundler:install</a> prior to activating a new release.</p>
<h3 id="railsdb_seed">rails:db_seed</h3>
<p>Loads seed data into the database. Seeds should be written to be idempotent, such that it is safe to seed the database on each deploy. Typically seeds are used to load reference data need for the app to function, or for example to create an initial admin user. This task runs the following script:</p>
<pre><code>cd /var/www/my-app/releases/&lt;RELEASE_NUMBER&gt; &amp;&amp; bundle exec rake db:seed
</code></pre>

<p><code>rails:db_seed</code> is intended for use as a <a href="../../commands/deploy/">deploy</a> task. Since seeds rely on the structure of the database, it is typically run just after <a href="#railsdb_migrate">rails:db_migrate</a>.</p>
<h3 id="railsdb_create">rails:db_create</h3>
<p>Runs <code>bundle exec rake db:create</code> to create the database. This task is intended for use as a <a href="../../commands/setup/">setup</a> task. It will be automatically skipped if the database already exists, so it is safe to re-run.</p>
<h3 id="railsdb_schema_load">rails:db_schema_load</h3>
<p>Runs <code>bundle exec rake db:schema:load</code> to load the schema from <code>db/schema.rb</code> into an existing database. This task is intended for use as a <a href="../../commands/setup/">setup</a> task after <code>rails:db_create</code>. It will be automatically skipped if the database already contains a schema, so it is safe to re-run.</p>
<h3 id="railsdb_structure_load">rails:db_structure_load</h3>
<p>Runs <code>bundle exec rake db:structure:load</code> to load the schema from <code>db/structure.sql</code> into an existing database. This task is intended for use as a <a href="../../commands/setup/">setup</a> task after <code>rails:db_create</code>. It will be automatically skipped if the database already contains a schema, so it is safe to re-run.</p>
<h2 id="helpers">Helpers</h2>
<p>These helper methods become available on instances of <a href="../../api/Remote/">Remote</a> when the rails plugin is loaded. They accept the same <code>options</code> as <a href="../../api/Remote/#run42command-4242options-tomoresult">Remote#run</a>.</p>
<h3 id="remoterails42args-4242options-tomoresult">remote.rails(*args, **options) → <a href="../../api/Result/">Tomo::Result</a></h3>
<p>Runs <code>bundle exec rails</code> in within <code>paths.release</code> by default.</p>
<pre><code class="ruby">remote.rails(&quot;routes&quot;)
# $ cd /var/www/my-app/releases/20190604204415 &amp;&amp; bundle exec rails routes
</code></pre>

<h3 id="remoterake42args-4242options-tomoresult">remote.rake(*args, **options) → <a href="../../api/Result/">Tomo::Result</a></h3>
<p>Runs <code>bundle exec rake</code> in within <code>paths.release</code> by default.</p>
<pre><code class="ruby">remote.rake(&quot;db:migrate&quot;)
# $ cd /var/www/my-app/releases/20190604204415 &amp;&amp; bundle exec rake db:migrate
</code></pre>

<h3 id="remoterake42args-4242options-true-or-false">remote.rake?(*args, **options) → true or false</h3>
<p>Like <code>rake</code> but returns <code>true</code> if the command succeeds (exit status 0), otherwise <code>false</code>.</p>
<pre><code class="ruby">remote.rake?(&quot;db:migrate&quot;) # =&gt; true
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../rbenv/" class="btn btn-neutral float-right" title="rbenv">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../puma/" class="btn btn-neutral" title="puma"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mattbrictson/tomo/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../puma/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../rbenv/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
